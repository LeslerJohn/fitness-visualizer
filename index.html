<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Exercise Template Visualizer - GitHub Pages Ready</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .navigation {
            text-align: center;
            margin-bottom: 20px;
        }

        .nav-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #ff5252 0%, #e53e3e 100%);
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 14px;
        }

        .filter-group select {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .filter-group select:focus {
            border-color: #667eea;
            outline: none;
        }

        .stats-bar {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 18px;
            color: #2c3e50;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 25px;
        }

        .template-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .template-id {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 15px;
            display: inline-block;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .somatotype-badge {
            background: #e74c3c;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .calories-display {
            font-size: 28px;
            font-weight: bold;
            color: #27ae60;
        }

        .meta-info {
            margin: 10px 0;
            color: #7f8c8d;
            font-size: 13px;
            line-height: 1.4;
        }

        .macros-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin: 20px 0;
        }

        .macro-box {
            text-align: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .macro-label {
            font-size: 11px;
            color: #6c757d;
            text-transform: uppercase;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .macro-value {
            font-size: 16px;
            font-weight: bold;
            color: #2c3e50;
        }

        .exercise-section {
            margin: 20px 0;
        }

        .exercise-section h4 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 14px;
            font-weight: bold;
            padding-bottom: 8px;
            border-bottom: 2px solid #667eea;
        }

        .exercises-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
        }

        .exercise-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .exercise-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .exercise-image {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 8px;
            background: #e9ecef;
        }

        .exercise-name {
            font-size: 10px;
            color: #495057;
            font-weight: 600;
            line-height: 1.2;
        }

        .description-box {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 0 8px 8px 0;
            font-size: 13px;
            color: #495057;
            line-height: 1.4;
        }

        .loading, .no-results {
            text-align: center;
            padding: 60px 20px;
            color: white;
            font-size: 18px;
        }

        .error {
            background: #e74c3c;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .templates-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-row {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèãÔ∏è‚Äç‚ôÇÔ∏è Exercise Template Visualizer</h1>
            <p>Complete Diet & Exercise Templates for All Somatotypes</p>
            <p><strong>‚úÖ Live Data Loading ‚Ä¢ üìä All 1080 Templates ‚Ä¢ üéØ Proper Exercise IDs & GIFs</strong></p>
        </div>

        <div class="navigation">
            <a href="food_visualizer.html" class="nav-button">
                üçΩÔ∏è View Food Recommendations
            </a>
        </div>

        <div class="controls">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="somatotype-filter">üß¨ Somatotype:</label>
                    <select id="somatotype-filter">
                        <option value="">All Somatotypes</option>
                        <option value="ectomorph">Ectomorph</option>
                        <option value="mesomorph">Mesomorph</option>
                        <option value="endomorph">Endomorph</option>
                        <option value="ecto_endo">Ecto-Endomorph</option>
                        <option value="meso_ecto">Meso-Ectomorph</option>
                        <option value="endo_meso">Endo-Mesomorph</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="gender-filter">üë§ Gender:</label>
                    <select id="gender-filter">
                        <option value="">All Genders</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="goal-filter">üéØ Goal:</label>
                    <select id="goal-filter">
                        <option value="">All Goals</option>
                        <option value="weight_loss">Weight Loss</option>
                        <option value="weight_gain">Weight Gain</option>
                        <option value="maintenance">Maintenance</option>
                    </select>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-group">
                    <label for="activity-filter">‚ö° Activity Level:</label>
                    <select id="activity-filter">
                        <option value="">All Activity Levels</option>
                        <option value="sedentary">Sedentary</option>
                        <option value="lightly_active">Lightly Active</option>
                        <option value="moderately_active">Moderately Active</option>
                        <option value="very_active">Very Active</option>
                        <option value="extremely_active">Extremely Active</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="complexity-filter">üìä Exercise Complexity:</label>
                    <select id="complexity-filter">
                        <option value="">All Complexity</option>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="hard">Advanced</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="type-filter">üèÉ‚Äç‚ôÇÔ∏è Exercise Type:</label>
                    <select id="type-filter">
                        <option value="">All Types</option>
                        <option value="gym">Gym</option>
                        <option value="bodyweight">Bodyweight</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="stats-bar" id="stats-bar">
            Loading templates...
        </div>

        <div class="templates-grid" id="templates-container">
            <div class="loading">üîÑ Loading exercise templates...</div>
        </div>
    </div>

    <script>
        // Global variables to store loaded data
        let exerciseDatabase = {};
        let allTemplates = [];
        let filteredTemplates = [];

        // Load data from actual files
        async function loadData() {
            try {
                console.log('üîÑ Loading data from files...');
                
                // Load CSV templates
                const csvResponse = await fetch('./fixed_comprehensive_diet_templates_with_proper_exercise_ids.csv');
                if (!csvResponse.ok) {
                    throw new Error(`Failed to load CSV: ${csvResponse.status} ${csvResponse.statusText}`);
                }
                const csvText = await csvResponse.text();
                console.log('‚úÖ CSV loaded successfully');
                
                // Load exercise database
                const exerciseResponse = await fetch('./exercises.json');
                if (!exerciseResponse.ok) {
                    throw new Error(`Failed to load exercises: ${exerciseResponse.status} ${exerciseResponse.statusText}`);
                }
                const allExerciseData = await exerciseResponse.json();
                console.log('‚úÖ Exercise database loaded successfully:', allExerciseData.length, 'exercises');
                
                // Convert exercise array to lookup object
                exerciseDatabase = {};
                allExerciseData.forEach(exercise => {
                    exerciseDatabase[exercise.exerciseId] = exercise;
                });
                console.log('‚úÖ Exercise database indexed by ID');
                
                // Parse CSV data
                allTemplates = parseCSVData(csvText);
                filteredTemplates = [...allTemplates];
                console.log('‚úÖ Templates parsed:', allTemplates.length);
                
                // Initialize the app
                renderTemplates();
                updateStats();
                setupEventListeners();
                
            } catch (error) {
                console.error('‚ùå Error loading data:', error);
                document.getElementById('templates-container').innerHTML = `
                    <div class="error">
                        ‚ùå Error loading data: ${error.message}
                        <br><br>Please ensure all files are in the correct location:
                        <br>‚Ä¢ fixed_comprehensive_diet_templates_with_proper_exercise_ids.csv
                        <br>‚Ä¢ data/datasets/fitness/data/exercises.json
                    </div>
                `;
            }
        }

        // Utility Functions
        function parseCSVData(csvString) {
            const lines = csvString.trim().split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = [];
                let currentValue = '';
                let insideQuotes = false;
                
                for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    if (char === '"' && (j === 0 || lines[i][j-1] === ',')) {
                        insideQuotes = true;
                    } else if (char === '"' && (j === lines[i].length - 1 || lines[i][j+1] === ',')) {
                        insideQuotes = false;
                    } else if (char === ',' && !insideQuotes) {
                        values.push(currentValue.trim());
                        currentValue = '';
                    } else {
                        currentValue += char;
                    }
                }
                values.push(currentValue.trim());
                
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] || '';
                });
                data.push(row);
            }
            return data;
        }

        function formatText(text) {
            return text.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        }

        function getSomatotypeBadgeColor(somatotype) {
            const colors = {
                'ectomorph': '#3498db',
                'mesomorph': '#e74c3c', 
                'endomorph': '#f39c12',
                'ecto_endo': '#9b59b6',
                'meso_ecto': '#1abc9c',
                'endo_meso': '#e67e22'
            };
            return colors[somatotype] || '#95a5a6';
        }

        function createExerciseElement(exerciseId) {
            const exercise = exerciseDatabase[exerciseId];
            if (!exercise) {
                console.warn('Exercise not found:', exerciseId);
                return `
                    <div class="exercise-item">
                        <div class="exercise-image" style="background: #ddd; display: flex; align-items: center; justify-content: center; color: #666; font-size: 10px;">
                            Not Found
                        </div>
                        <div class="exercise-name">${exerciseId}</div>
                    </div>
                `;
            }

            return `
                <div class="exercise-item">
                    <img src="${exercise.gifUrl}" alt="${exercise.name}" class="exercise-image" loading="lazy" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'; this.nextElementSibling.style.alignItems='center'; this.nextElementSibling.style.justifyContent='center'; this.nextElementSibling.style.background='#ddd'; this.nextElementSibling.style.color='#666'; this.nextElementSibling.style.fontSize='10px'; this.nextElementSibling.innerHTML='No GIF';">
                    <div style="display:none; width: 70px; height: 70px; border-radius: 6px; margin-bottom: 8px;">No GIF</div>
                    <div class="exercise-name">${exercise.name}</div>
                </div>
            `;
        }

        function createTemplateCard(template) {
            const pushExercises = template.push_exercises ? template.push_exercises.split(',').map(e => e.trim()) : [];
            const pullExercises = template.pull_exercises ? template.pull_exercises.split(',').map(e => e.trim()) : [];
            const legExercises = template.legs_exercises ? template.legs_exercises.split(',').map(e => e.trim()) : [];
            const bodyweightExercises = template.bodyweight_exercises ? template.bodyweight_exercises.split(',').map(e => e.trim()) : [];

            const somatotypeBadgeColor = getSomatotypeBadgeColor(template.somatotype);

            return `
                <div class="template-card">
                    <div class="template-id">${template.template_id}</div>
                    
                    <div class="template-header">
                        <div>
                            <div class="somatotype-badge" style="background-color: ${somatotypeBadgeColor};">
                                ${formatText(template.somatotype)}
                            </div>
                            <div class="meta-info">
                                <strong>${template.gender?.toUpperCase()}</strong> ‚Ä¢ ${formatText(template.goal)}
                                <br>${formatText(template.activity_level)} ‚Ä¢ ${formatText(template.exercise_complexity)} ‚Ä¢ ${formatText(template.exercise_type)}
                            </div>
                        </div>
                        <div class="calories-display">${template.total_calories}</div>
                    </div>

                    <div class="macros-grid">
                        <div class="macro-box">
                            <div class="macro-label">Protein</div>
                            <div class="macro-value">${template.protein_g}g</div>
                        </div>
                        <div class="macro-box">
                            <div class="macro-label">Carbs</div>
                            <div class="macro-value">${template.carbs_g}g</div>
                        </div>
                        <div class="macro-box">
                            <div class="macro-label">Fats</div>
                            <div class="macro-value">${template.fats_g}g</div>
                        </div>
                    </div>

                    ${pushExercises.length > 0 ? `
                        <div class="exercise-section">
                            <h4>üí™ Push Exercises (Chest, Shoulders, Triceps)</h4>
                            <div class="exercises-grid">
                                ${pushExercises.map(createExerciseElement).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${pullExercises.length > 0 ? `
                        <div class="exercise-section">
                            <h4>üîô Pull Exercises (Back, Biceps)</h4>
                            <div class="exercises-grid">
                                ${pullExercises.map(createExerciseElement).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${legExercises.length > 0 ? `
                        <div class="exercise-section">
                            <h4>ü¶µ Leg Exercises (Legs, Traps)</h4>
                            <div class="exercises-grid">
                                ${legExercises.map(createExerciseElement).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${bodyweightExercises.length > 0 ? `
                        <div class="exercise-section">
                            <h4>üèÉ‚Äç‚ôÇÔ∏è Bodyweight Exercises</h4>
                            <div class="exercises-grid">
                                ${bodyweightExercises.map(createExerciseElement).join('')}
                            </div>
                        </div>
                    ` : ''}

                    <div class="description-box">
                        <strong>Somatotype Description:</strong> ${template.description || 'No description available'}
                    </div>
                </div>
            `;
        }

        function applyFilters() {
            const filters = {
                somatotype: document.getElementById('somatotype-filter').value,
                gender: document.getElementById('gender-filter').value,
                goal: document.getElementById('goal-filter').value,
                activity: document.getElementById('activity-filter').value,
                complexity: document.getElementById('complexity-filter').value,
                type: document.getElementById('type-filter').value
            };

            filteredTemplates = allTemplates.filter(template => {
                return (!filters.somatotype || template.somatotype === filters.somatotype) &&
                       (!filters.gender || template.gender === filters.gender) &&
                       (!filters.goal || template.goal === filters.goal) &&
                       (!filters.activity || template.activity_level === filters.activity) &&
                       (!filters.complexity || template.exercise_complexity === filters.complexity) &&
                       (!filters.type || template.exercise_type === filters.type);
            });

            renderTemplates();
            updateStats();
        }

        function renderTemplates() {
            const container = document.getElementById('templates-container');
            
            if (filteredTemplates.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        üîç No templates found matching your filters.<br>
                        Try adjusting your filter criteria.
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTemplates.map(createTemplateCard).join('');
        }

        function updateStats() {
            const stats = document.getElementById('stats-bar');
            stats.textContent = `üìä Showing ${filteredTemplates.length} of ${allTemplates.length} templates`;
        }

        function setupEventListeners() {
            const filterIds = ['somatotype-filter', 'gender-filter', 'goal-filter', 'activity-filter', 'complexity-filter', 'type-filter'];
            filterIds.forEach(id => {
                document.getElementById(id).addEventListener('change', applyFilters);
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
